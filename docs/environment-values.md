# Environment Configuration Cheat Sheet

This repository already encodes the values you need for a live deployment on Render (backend) and either Render or Vercel (frontend). The table below pulls the values directly from `render.yaml`, `.env` files, and backend defaults so you don't have to hunt for them.

> **Tip:** Items marked **(secret)** must be populated with your own secure value in the hosting dashboard – they are intentionally empty in the repo.

## Backend Web Service (Render)

| Key                           | Value                     | Source / Notes                                                                                                                                                                                                                                                                                                                                |
| ----------------------------- | ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- |
| `PORT`                        | `8000`                    | `render.yaml`                                                                                                                                                                                                                                                                                                                                 |
| `USE_IN_MEMORY_DB`            | `"false"`                 | `render.yaml` (must stay `false` in production)                                                                                                                                                                                                                                                                                               |
| `MONGO_URL`                   | **(secret)**              | Render secret; paste your MongoDB connection string                                                                                                                                                                                                                                                                                           |
| `DB_NAME`                     | `mkproptech`              | `render.yaml`                                                                                                                                                                                                                                                                                                                                 |
| `AUTH_SECRET`                 | **(secret)**              | JWT signing secret; configure in Render                                                                                                                                                                                                                                                                                                       |
| `ACCESS_TOKEN_EXPIRE_MINUTES` | `"120"`                   | `render.yaml`                                                                                                                                                                                                                                                                                                                                 |
| `API_TOKENS`                  | **(secret)**              | Optional comma-separated tokens (`token:role                                                                                                                                                                                                                                                                                                  | scope1;scope2`) – leave blank if unused |
| `CORS_ORIGINS`                | `https://app.example.com` | Update to your public frontend domain if different                                                                                                                                                                                                                                                                                            |
| `DEFAULT_TENANT_ID`           | `tenant-default`          | `render.yaml`                                                                                                                                                                                                                                                                                                                                 |
| `DEFAULT_TENANT_NAME`         | `Primarni profil`         | `render.yaml`                                                                                                                                                                                                                                                                                                                                 |
| `DEFAULT_TENANT_STATUS`       | `active`                  | `render.yaml`                                                                                                                                                                                                                                                                                                                                 |
| `INITIAL_ADMIN_EMAIL`         | **(secret)**              | Only needed on first deploy to seed the admin user                                                                                                                                                                                                                                                                                            |
| `INITIAL_ADMIN_PASSWORD`      | **(secret)**              | Set alongside `INITIAL_ADMIN_EMAIL`, remove after seeding                                                                                                                                                                                                                                                                                     |
| `INITIAL_ADMIN_FULL_NAME`     | `Portfolio Admin`         | `render.yaml`                                                                                                                                                                                                                                                                                                                                 |
| `INITIAL_ADMIN_ROLE`          | `admin`                   | `render.yaml`                                                                                                                                                                                                                                                                                                                                 |
| `AUTO_RUN_MIGRATIONS`         | `"true"`                  | `render.yaml`; keeps migrations automatic                                                                                                                                                                                                                                                                                                     |
| `SEED_ADMIN_ON_STARTUP`       | `"false"`                 | `render.yaml`; leave `false` once admin exists                                                                                                                                                                                                                                                                                                |
| `OPENAI_API_KEY`              | **(secret)**              | Required for AI PDF parsing; optional if feature disabled                                                                                                                                                                                                                                                                                     |
| `MAILGUN_API_KEY`             | **(secret)**              | Needed if Mailgun emails enabled                                                                                                                                                                                                                                                                                                              |
| _Optional overrides_          |                           | If you need custom templates or document config:<br>`DOCUMENT_REQUIREMENTS_PATH` (defaults to `frontend/src/shared/documentRequirements.json`)<br>`ANEKS_TEMPLATE_PATH` (defaults to `brand/aneks-template.html`)<br>`UGOVOR_TEMPLATE_PATH` (defaults to `brand/ugovor-template.html`)<br>`OPENAI_DOCUMENT_MODEL` (defaults to `gpt-4o-mini`) |

### Post-deploy steps

- Attach a persistent disk on Render at `/app/uploads` to keep uploaded files.
- After the first boot, run `python -m backend.manage migrate` from the Render shell.
- If you set `INITIAL_ADMIN_*`, run `python -m backend.manage seed-admin` and then clear those secrets.

## Frontend Static Hosting

| Key                           | Value                                          | Source / Notes                                                                          |
| ----------------------------- | ---------------------------------------------- | --------------------------------------------------------------------------------------- |
| `REACT_APP_BACKEND_URL`       | `https://mk-proptech-backend.onrender.com/api` | `render.yaml` / `vercel.json`; swap to your live backend domain                         |
| `REACT_APP_ENV`               | `production`                                   | `render.yaml` & `.env.production.example`                                               |
| `REACT_APP_SENTRY_DSN`        | _(empty)_                                      | Fill in only if you have a Sentry project                                               |
| `REACT_APP_DEFAULT_TENANT_ID` | `tenant-default`                               | Optional override; backend default is the same                                          |
| `REACT_APP_DEV_AUTH_TOKEN`    | `token123`                                     | Dev bypass token used by `scripts/start_frontend.sh`; not required in production builds |

### Local development reference

- Backend fallback URL: `http://localhost:8000` (see `frontend/.env` and `backend_test.py`).
- Smoke tests expect `BACKEND_BASE_URL`, `BACKEND_TENANT_ID`, and an `BACKEND_API_TOKEN` or login credentials (see `backend_test.py`).

## Quick Verification Checklist

1. **Render dashboard** – confirm every key above is present and secrets are populated.
2. **MongoDB Atlas** – make sure the user/whitelist matches Render’s connection.
3. **Frontend host (Render static site or Vercel)** – update `REACT_APP_BACKEND_URL` to your public API URL and redeploy.
4. **CORS** – keep `CORS_ORIGINS` in sync with the frontend domain(s).
5. **Uploads** – verify the persistent disk is mounted and `/api/health` returns `OK`.

With these values in place you can trigger a Render/Vercel deploy and the stack should come up without additional manual edits.
