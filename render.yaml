services:
  - type: web
    name: mk-proptech-backend
    env: docker
    plan: starter
    region: oregon
    dockerfilePath: backend/Dockerfile
    autoDeploy: true
    envVars:
      - key: PORT
        value: 8000
      - key: USE_IN_MEMORY_DB
        value: "false"
      - key: DATABASE_URL
        sync: false
      - key: DB_NAME
        value: mkproptech
      - key: AUTH_SECRET
        sync: false
      - key: ACCESS_TOKEN_EXPIRE_MINUTES
        value: "120"
      - key: API_TOKENS
        sync: false
      - key: CORS_ORIGINS
        value: https://app.example.com
      - key: DEFAULT_TENANT_ID
        value: tenant-default
      - key: DEFAULT_TENANT_NAME
        value: Primarni profil
      - key: INITIAL_ADMIN_EMAIL
        sync: false
      - key: INITIAL_ADMIN_PASSWORD
        sync: false
      - key: INITIAL_ADMIN_FULL_NAME
        value: Portfolio Admin
      - key: INITIAL_ADMIN_ROLE
        value: admin
      - key: AUTO_RUN_MIGRATIONS
        value: "true"
      - key: SEED_ADMIN_ON_STARTUP
        value: "false"
      - key: OPENAI_API_KEY
        sync: false
      - key: MAILGUN_API_KEY
        sync: false
      - key: DEFAULT_TENANT_STATUS
        value: active
    healthCheckPath: /api/health

staticSites:
  - name: mk-proptech-frontend
    plan: starter
    region: oregon
    buildCommand: corepack yarn --cwd frontend install && corepack yarn --cwd frontend build
    publishPath: frontend/build
    envVars:
      - key: REACT_APP_BACKEND_URL
        value: https://mk-proptech-backend.onrender.com/api
      - key: REACT_APP_ENV
        value: production
    headers:
      - path: "/*"
        name: Strict-Transport-Security
        value: max-age=63072000; includeSubDomains; preload
      - path: "/*"
        name: X-Frame-Options
        value: SAMEORIGIN
